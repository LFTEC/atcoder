# 子集的最大公约数 - 智力型

## Problem Statement
给定一个长度为 $N$ 的序列 $A = (A_1, A_2, \dots, A_N)$ 和一个正整数 $K$ （ $K$ 不超过 $N$ ）。对于每个 $i = 1, 2, \dots, N$ ，解决以下问题：

当从 $A$ 中选择包含 $A_i$ 的 $K$ 个元素时，找出这些被选元素的最大可能 GCD（最大公约数）。

## Constraints
- $1 \leq K \leq N \leq 1.2 \times 10^6$ 
- $1 \leq A_i \leq 10^6$ 
- 所有输入值均为整数。

## Input
输入通过标准输入给出，格式如下：

```math
\begin{align}
N\ K \\
A_1\ A_2\  A_3\ ...\ A_N
\end{align}
```

## Output
输出 $N$ 行。第 $j$ 行应包含 $i = j$ 时的答案。

## Sample Input 1
```
5 2
3 4 6 7 12
```

## Sample Output 1
```
3
4
6
1
6

```

- 对于 $i = 1$ ，选择 $A_1$ 和 $A_3$ 得到 $\gcd(\{3, 6\}) = 3$ ，这是最大值。
- 对于 $i = 2$ ，选择 $A_2$ 和 $A_5$ 得到 $\gcd(\{4, 12\}) = 4$ ，这是最大值。
- 对于 $i = 3$ ，选择 $A_3$ 和 $A_5$ 得到 $\gcd(\{6, 12\}) = 6$ ，这是最大值。
- 对于 $i = 4$ ，选择 $A_4$ 和 $A_2$ 得到 $\gcd(\{7, 4\}) = 1$ ，这是最大值。
- 对于 $i = 5$ ，选择 $A_5$ 和 $A_3$ 得到 $\gcd(\{12, 6\}) = 6$ ，这是最大值。

## Sample Input 2
```
3 3
6 10 15
```

## Sample Output 2
```
1
1
1
```

## Sample Input 3
```
10 3
414003 854320 485570 52740 833292 625990 909680 885153 435420 221663
```

## Sample Output 3
```
59
590
590
879
879
590
20
879
590
59
```

## 解析
设 $x_i$ 是第 $i$ 个数的答案，那么它一定满足下面的情况
- $x_i|A_i$
- 在序列 $A$ 中，满足至少有 $K$ 个数可以被 $x_i$整除。
- $x_i$是满足上面两个条件的 $x$ 中最大的

因此，要找到 $x_i$，需要先计算下面几个变量。

设 $S[n] (n \in A) $为序列A中每个值出现的次数  
设 $T[d] (d \in 1 \cdots M, M = max(A) )$ 为序列A中所有可被d整除的数的个数，因此有 $T[d] = \sum_{d|n} S[n]$。  
设 $u[n] (n \in A)$ 为包含n的所有子序列的最大公约数，即答案。则有 $u[n] = max(d (d \in (1 \cdots M)\ M = max(A)), d|n\ and\ t[d] >= K)$

因此我们需要有三个循环，第一个计算S[n]，第二个计算T[d]，第三个计算u[n]。
然后再通过循环序列A中的每个元素，打印出答案即可。

  

